\documentclass[a4paper, 12pt]{report}

%% Imports
\usepackage[utf8]{inputenc}
\usepackage{a4wide}
\usepackage[hidelinks]{hyperref}
\usepackage{myshortcuts}
\usepackage{titlesec}
\usepackage{epigraph}
\usepackage{stmaryrd}
\usepackage[american]{babel}
\usepackage{csquotes}
\usepackage{tikz}
\usepackage[style=mla,backend=biber]{biblatex}
% clickable table of contents
\hypersetup{
    linktoc=all,
}

% fancy chapter title
\usepackage[T1]{fontenc}
\usepackage{titlesec, blindtext, color}
\definecolor{gray75}{gray}{0.75}
\newcommand{\hsp}{\hspace{20pt}}
\titleformat{\chapter}[hang]{\Huge\bfseries\scshape}{\thechapter\hsp\textcolor{gray75}{|}\hsp}{0pt}{\Huge\bfseries}
% MLA citations; `autocite{}` to cite
\addbibresource{sources.bib}

% \defbibheading{bibliography}{
%     % Change title from "Works Cited" to "Works Consulted"
%     \chapter*{Works Consulted}
% }


%% Preamble
\title{
    % Title of EE
    \Huge Mathematics Extended Essay\\
    \bigskip
    % Subtitle: Research question
    \Large How can we use generating functions to solve linear recurrence relations with constant coefficients?
}
% Make anonymous
\author{}
% Month and year of graduation
\date{
    May 2019\\
    \vspace{12.5cm}
    \small
    4008 words
}


\begin{document}
\thispagestyle{empty}
\pagenumbering{gobble}
\maketitle


% TODO page number on abstract page?
\pagenumbering{arabic}
\chapter*{Abstract}
\thispagestyle{empty}
Recurrence relations arise in mathematics as solutions to combinatorical problems and in computer science as models of recursive algorithms' behaviour. They provide local, indirect information about the sequence that does not facilitate the calculation of arbitrary terms. Therefore, we desire to obtain a closed-form formula for $F_n$ from a recursive definition such as $F_0 = 0, F_1 = 1, F_n = F_{n - 1} + F_{n - 2}$ for $n \geq 2$.

This essay aims to present the merits of representing a sequence $\{a_n\}$ as a power series: $f = a_0 + a_1 X + a_2 X^2 + \cdots = \sum_{n = 0}^\infty a_n X^n$. $f$ can be viewed as a complex-valued function, with $X$ chosen to be inside the radius of convergence; alternatively, it can be viewed as a formal power series where convergence becomes irrelevant since $X$ is an intermediate. We base ourselves on the latter: by defining addition, multiplication, and derivation in a similar fashion to those operations of polynomials, we show that the associative, commutative, and distributive properties of multiplication as well as the sum, product, and power rules are equally valid. We produce a list of useful generating functions --- notably, $1 + X + X^2 + \cdots = \dfrac{1}{1 - X}$.

Solving linear recurrence relations with constant coefficients is one of the most important applications of generating functions. It can be shown that the generating function of a sequence satisfying a linear homogeneous recurrence relation is of the form $\dfrac{p_0 + p_1 X + \cdots + p_m X^m}{q_0 + q_1 X + \cdots + q_k X^k}$. The denominator corresponds to the characteristic polynomial of the recurrence relation, while the numerator is related to the initial conditions. In addition to revealing structural information about sequences, the closed-form formula can be obtained via partial fraction decomposition. Further, instead of remembering tips and tricks for guessing a particular solution, it is possible to directly find the generating function of certain non-homogeneous terms.

% \begin{flushright}
% {\small 300 words}
% \end{flushright}

\tableofcontents

\chapter{Introductory Ideas}\label{ch:intro}
\epigraph{A generating function is a clothesline on which we hang up a sequence of numbers for display.}{Herbert Wilf}
% Research question stated
% Hypothesis
% Explanation of topic choice: why interesting? connection to passion?
% Description of academic context: relation to IB subjects
% Brief description of research question over time
% Brief description of how research question will be answered
% A description of the conclusion: q answered? hypotheses?

When we encounter a complicated problem, we often find it useful to break it down into two parts: the trivial cases, and how we can derive a solution from the solutions of sub-problems. Consider this problem: short syllables are 1 unit of duration, and long syllables 2; how many different patterns of short and long syllables of $n$ units in total are there?

\begin{figure}[h]
    \centering
    \begin{tikzpicture}
    \filldraw[color=blue!60, fill=blue!5, very thick] (0, 0) rectangle (1, 1);
    \filldraw[color=red!60, fill=red!5, very thick] (2, 0) rectangle (4, 1);
    \end{tikzpicture}
    \caption{Short and long syllables, figure made with tikz}
    \label{fig:short_long}
\end{figure}

We start by considering the trivial cases. When $n = 0$, there is exactly 1 pattern: not using any syllables. When $n = 1$, only 1 short syllable can fit, so there is only 1 pattern as well.

We then consider the relation between the number of patterns of $n$ units long and the number of patterns of $n - 1, n - 2, ...$ units long.

\begin{figure}[h]
    \centering
    \begin{tikzpicture}
    \filldraw[color=blue!60, fill=blue!5, very thick] (4, 1.5) rectangle (5, 2.5);
    \node at (1.5, 2) {$\overbrace{\cdots}^{n - 1\text{ units}}$};
    \filldraw[color=red!60, fill=red!5, very thick] (3, 0) rectangle (5, 1);
    \node at (1.5, 0.5) {$\overbrace{\cdots}^{n - 2\text{ units}}$};
    \end{tikzpicture}
    \caption{Number of patterns of $n$ units long, figure made with tikz}
    \label{fig:rec}
\end{figure}

When counting the patterns of $n$ units long, we notice that it either ends with a short syllable or a long syllable. These correspond to patterns of $n - 1$ and $n - 2$ units long, respectively.

If we denote with $f_n$ the number of patterns of $n + 1$ units long, with $f_0 = 0$, we have:
\[\begin{cases}
F_0 = 0, F_1 = 1\\
F_n = F_{n - 1} + F_{n - 2}, n \geq 2.
\end{cases}\]

These are the Fibonacci numbers defined in a recursive manner. The recurrence relation, however, only gives us local, indirect information. It is easy to compute $F_2$ from $F_0$ and $F_1$, but the calculation of $F_n$ for arbitrary (especially for large) $n$ would be tedious. We are then interested in finding a closed-form expression for $F_n$. 

The discrete nature of $\{F_n\}$ as a sequence is to an extent an obstacle. Instead, if we were to encode $\{F_n\}$ as a power series $F_0 + F_1 X + F_2 X^2 + \cdots$, many manipulations become available. This is called the generating function of $\{F_n\}$, which we denote with $f \longleftrightarrow \{F_n\}$. It will be shown later that, after some arithmetic, we can deduce that $f = \dfrac{X}{1 - X - X^2}$. It is then possible to use the Maclaurin series to obtain $F_n = -\frac{1}{\sqrt{5}} \left(\frac{1 - \sqrt{5}}{2}\right)^n + \frac{1}{\sqrt{5}} \left(\frac{1 + \sqrt{5}}{2}\right)^n$.

I initially encountered this kind of problem in computer science, when I attempted to analyse the efficiency of a recursive algorithm. Indeed, recurrence relations appear in maths, computer science, and many other fields since they find use in problems from enumeration of structures to analysis of recursive algorithms. I then found that the discrete mathematics option of the IB HL maths textbook includes a treatment of second-order linear recurrence relations with constant coefficients. When it comes to non-homogeneous recurrence relations, however, a particular solution must be guessed. I wondered if there was any method to solve such recurrence relations without needing to make guesses, and I discovered generating functions as a powerful tool to solve linear recurrence relations.

This essay will focus on how generating functions can be used to solve linear recurrence relations with constant coefficients. At first, I wanted to focus more on the diverse applications of generating functions in combinatorics and probabilities: probability generating functions, for example. Nonetheless, a survey of literature revealed that most authors disregard the problem of convergence of the power series, and proceeded to add, multiply, and derive generating functions without knowing whether they are defined --- such is the case in the statistics and probability option in IB HL maths. Instead, a theory of formal power series is often known or presumed. As an inquirer, I became increasingly interested by this algebraic aspect of generating functions that asserts the validity of many operations on analytic functions without the concerns of convergence.

The essay is organised as follows. Firstly, we define generating functions as formal power series in order to state the formulations of basic arithmetic operations, shifting, and derivation. In the process, we prove the validity of many properties which allows the derivation of commonly used generating functions. Then, we focus on solving linear recurrence relations with generating functions. We start by stating a theorem about solutions to homogeneous recurrence relations, which is then compared with the approach using generating functions to reveal many similarities. The connection between generating functions and recurrence relations is further shown when we consider non-homogeneous recurrence relations. We conclude with discussions on the form and name of generating functions.

\chapter{Generating Functions}\label{ch:gf}
\section{Terms and definitions}
\begin{defn}\label{def:gf-def}
A \textbf{generating function} (or \textbf{formal power series}) is an expression of the form 
\[\sum_{n = 0}^{\infty} a_n X^n = a_0 + a_1 X + a_2 X^2 + \cdots\]
where $a_0, a_1, a_2, \dots \in \C$. We use $\C\llbracket X \rrbracket$ to denote the set of generating functions.
\end{defn}

Despite the name, generating functions are not functions: $X$ is not a variable, and the power series is not to be evaluated at any value of $X$. Rather, they are formal expressions, where $\sum$ is conventionally used for formal summation. The symbol $X$ is merely a convenient and intuitive way to indicate positions in the sequence and to describe some helpful operations on sequences that are analogous to those on functions (e.g. differentiation). The other part of the name, on the other hand, is easier to make sense of, as we can say the formal power series $\sum_{n = 0}^{\infty} a_n X^n$ ``generates'' the sequence $\{a_n\}_0^\infty$, i.e. $\{a_0, a_1, a_2, \dots\}$.

\begin{defn}\label{def:gf-seq}
 $f$ is the generating function of sequence $\{a_n\}$ if and only if $f = \sum_{n = 0}^{\infty} a_n X^n$. We write 
 \[f \longleftrightarrow \{a_n\}.\]
\end{defn}
\begin{ex*}\label{ex:gf-111}
$$\sum_{n = 0}^\infty X^n \longleftrightarrow \{1, 1, 1, \dots\}$$
\end{ex*}

\begin{defn}\label{def:gf-eq}
Let $f \longleftrightarrow \{a_n\}$ and $g \longleftrightarrow \{g_n\}$. $f = g$ if and only if $a_n = b_n$ for all $n \geq 0$.
\end{defn}

\begin{lem}\label{lem:gf-id-r}
Let $f \longleftrightarrow \{a_n\}$ and $r \in \C$. $f = r \iff \begin{cases}
    a_0 = r\\
    a_n = 0, \quad n \geq 1.
\end{cases}$
\end{lem}
\begin{proof}\label{proof:gf-id-r}
\[r = r + 0X + 0X^2 + \cdots \longleftrightarrow \{r, 0, 0, \dots\}\]
By definition~\ref{def:gf-eq}, we have $\begin{cases}
a_0 = r\\
a_n = 0, \quad n \geq 1.
\end{cases}$
\end{proof}

Having constructed $\C\llbracket X \rrbracket$ with the definition and equivalence of generating functions, we will proceed to study some operations defined in $\C\llbracket X \rrbracket$.

\section{Basic arithmetic operations}
\subsection{Addition and subtraction}
\begin{defn}\label{def:gf-addition}
\textbf{(addition)} Let $f \longleftrightarrow \{a_n\}$ and $g \longleftrightarrow \{b_n\}$. Then $f + g \longleftrightarrow \{a_n + b_n\}$.
\begin{alignat*}{5}
    f = \sum_{n = 0}^\infty a_n X^n &\longleftrightarrow \{&&a_1, &&a_2, &&a_3, &&\dots\}\\
    g = \sum_{n = 0}^\infty b_n X^n &\longleftrightarrow \{&&b_1, &&b_2, &&b_3, &&\dots\}\\
    f + g = \sum_{n = 0}^\infty (a_n + b_n) X^n &\longleftrightarrow \{&&a_1 + b_1,~&&a_2 + b_2,~&&a_3 + b_3,~&&\dots\}
\end{alignat*}
\end{defn}
\begin{rem}\label{rem:gf-addition-properties}
It follows directly from definition~\ref{def:gf-addition} that addition in $R\llbracket X \rrbracket$ is:
\begin{itemize}
    \item \textbf{associative} --- $\forall f, g, h \in \C\llbracket X \rrbracket, (f + g) + h = f + (g + h)$,
    \item \textbf{commutative} --- $\forall f, g \in \C\llbracket X \rrbracket, f + g = g + f$, and in particular, $f + 0 = 0 + f = f$,
    \item and \textbf{invertible} --- $\forall f \in \C\llbracket X \rrbracket, \exists ({-f})$, the additive inverse such that $f + (-f) = 0$. Further, $-f \longleftrightarrow \{-a_n\}$ and is hence unique. We then define \textbf{subtraction} with $-f$.
\end{itemize}
\end{rem}

\subsection{Multiplication and division}
\begin{defn}\label{def:gf-multiplication}
\textbf{(multiplication)} Let $f \longleftrightarrow \{a_n\}$ and $g \longleftrightarrow \{b_n\}$. Then $f \cdot g \longleftrightarrow \{c_n\}$, where $c_n = \sum_{k = 0}^{n} a_k b_{n - k}$. This generalises multiplication of polynomials to infinite degrees.
\begin{align*}
f = \sum_{n = 0}^\infty a_n X^n &= a_0 + a_1 X + a_2 X^2 + \cdots\\
g = \sum_{n = 0}^\infty b_n X^n &= b_0 + b_1 X + b_2 X^2 + \cdots\\
f \cdot g = \sum_{n = 0}^\infty \left(\sum_{k = 0}^n a_k b_{n - k}\right) X^n &= a_0 b_0 + (a_0 b_1 + a_1 b_0) X + (a_0 b_2 + a_1 b_1 + a_2 b_0) X^2 + \cdots\\
\end{align*}
\end{defn}

\begin{prop}\label{prop:gf-mult-properties}
Multiplication in $\C\llbracket X \rrbracket$ is \begin{itemize}
\item \textbf{associative} --- $\forall f, g, h \in \C\llbracket X \rrbracket, (f \cdot g) \cdot h = f \cdot (g \cdot h)$,
\item \textbf{commutative} --- $\forall f, g \in \C\llbracket X \rrbracket, f \cdot g = g \cdot f$, and in particular $f \cdot 1 = 1 \cdot f = 1$,
\item and \textbf{distributive} over addition --- $\forall f, g, h \in \C\llbracket X \rrbracket, f \cdot (g + h) = f \cdot g + f \cdot h$.
\end{itemize}
\end{prop}
\begin{proof}
Let $f \longleftrightarrow \{a_n\}, g \longleftrightarrow \{b_n\},$ and $h \longleftrightarrow \{c_n\}$.
\begin{align*}
(f \cdot g) \cdot h 
&= \left(\sum_{n = 0}^\infty \left(\sum_{k = 0}^n a_k b_{n - k}\right) X^n\right) \left(\sum_{n = 0}^\infty c_n X^n\right)\\
&= \sum_{n = 0}^\infty \left(\sum_{k = 0}^n \left(\sum_{j = 0}^k a_j b_{k - j} \right) c_{n - k}\right) X^n\\
&= \sum_{n = 0}^\infty \left(\sum_{k = 0}^n a_k \left(\sum_{j = 0}^{n - k} b_{j} c_{n - j - k}\right)\right) X^n\\
&= \left(\sum_{n = 0}^\infty a_n X^n\right) \left(\sum_{n = 0}^\infty \left(\sum_{k = 0}^n b_k c_{n - k}\right) X^n \right)\\
&= f \cdot (g \cdot h)\\
f \cdot g 
&= \sum_{n = 0}^\infty \left(\sum_{k = 0}^n a_k b_{n - k} \right) X^n
= \sum_{n = 0}^\infty \left(\sum_{k = 0}^n b_k a_{n - k} \right) X^n
= g \cdot f\\
1 \cdot f
&= f \cdot 1
= \sum_{n = 0}^\infty \left(\left(\sum_{k = 0}^{n - 1} a_k \cdot 0\right) + a_n \cdot 1\right) X^n
= \sum_{n = 0}^\infty a_n X^n
= f\\
f \cdot (g + h)
&= \left(\sum_{n = 0}^\infty a_n X^n\right)\left(\sum_{n = 0}^\infty (b_n + c_n) X^n\right)\\
&= \sum_{n = 0}^\infty \left(\sum_{k = 0}^n a_k (b_{n - k} + c_{n - k})\right) X^n\\
&=\left(\sum_{n = 0}^\infty \left(\sum_{k = 0}^n a_k b_{n - k}\right) X^n\right) 
+ \left(\sum_{n = 0}^\infty \left(\sum_{k = 0}^n a_k c_{n - k}\right) X^n\right)\\
&= f \cdot g + f \cdot h\\
\end{align*}
\end{proof}

\begin{prop}\label{prop:gf-mult-0}
$\forall f, g \in \C\llbracket X\rrbracket, f \cdot 0 = 0 \cdot f = 0; f \cdot g = 0 \iff f = 0 \text{ or } g = 0$.
\end{prop}
\begin{proof}
Let $f \longleftrightarrow \{a_n\}, g \longleftrightarrow \{b_n\}$. 

Firstly, $0 \cdot f = f \cdot 0 = \sum_{n = 0}^\infty \left(\sum_{k = 0}^n a_n \cdot 0\right)X^n = 0$.

As a result, $f = 0$ or $g = 0 \implies f \cdot g = 0$.

Then, we show $f \neq 0$ and $g \neq 0 \implies f \cdot g \neq 0$ which is equivalent to its contrapositive. Since $f \neq 0$, there exists $i$ such that $\forall k\in \{0, 1, 2, \dots, i\}, a_{k} = 0$ and $a_i \neq 0$; similarly, such $j$ exists for $g$ since $g \neq 0$. Let $f \cdot g \longleftrightarrow \{c_n\}$, where $c_n = \sum_{k = 0}^n a_k b_{n - k}$. Without loss of generality, suppose that $i \leq j$. Then, $c_{i + j} = (\sum_{k = 0}^{i - 1} 0 \cdot b_{i + j - k}) + a_i b_j + (\sum_{k = i + 1}^{i + j} a_{k} \cdot 0)\neq 0$.
\end{proof}

\begin{thm}\label{thm:gf-mult-inv}
Let $f \longleftrightarrow \{a_n\}$. $f$ has a unique multiplicative inverse, $\frac{1}{f}$, such that $f \cdot \frac{1}{f} = 1$, if and only if $a_0 \neq 0$. We then define \textbf{division} with $\frac{1}{f}$ if it exists.
\end{thm}
\begin{proof}
Let $\frac{1}{f} \longleftrightarrow \{b_n\}$. From definition~\ref{def:gf-multiplication} and lemma~\ref{lem:gf-id-r}, we have
\begin{align*}
    &\begin{cases}
        a_0 b_0 &= 1\\
        \sum_{k = 0}^n a_k b_{n - k} = \sum_{k = 1}^{n} a_k b_{n - k} + a_0 b_n &= 0, \quad n \geq 1
    \end{cases}\\
    \iff &\begin{cases}
        b_0 = \frac{1}{a_0}, &a_0 \neq 0\\
        b_n = -\frac{1}{a_0} \sum_{k = 1}^{n} a_n b_{n - k}, &a_0 \neq 0, n \geq 1.\\
    \end{cases}
\end{align*}
which uniquely determines $\{b_n\}$ and hence $\frac{1}{f}$.
\end{proof}
% \begin{cor}\label{cor:gf-1-lambda_X}
% $\dfrac{1}{1 - \lambda X} \longleftrightarrow \{1, \lambda, \lambda^2, \dots\}.$
% \end{cor}
% \begin{proof}
% Let $1 - \lambda X \longleftrightarrow \{a_n\}, \frac{1}{1 - \lambda X} \longleftrightarrow \{b_n\}$, where $a_0 = 1, a_1 = -\lambda, a_n = 0$ for all $n \geq 2$. By theorem~\ref{thm:gf-mult-inv},
% \begin{align*}
%     &\frac{1}{1 - \lambda X} \cdot (1 - \lambda X) = 1\\
%     \iff &\begin{cases}
%     b_0 &= \frac{1}{a_0}\\
%     b_n &= -\frac{1}{a_0} \sum_{k = 1}^{n} a_k b_{n - k} = -\frac{1}{a_0} (a_1 b_{n - 1} + \sum_{k = 2}^n a_k b_{n - k}), \quad n \geq 1
%     \end{cases}\\
%     \iff &\begin{cases}
%     b_0 &= \frac{1}{1} = 1 = \lambda^0\\
%     b_n &= - \frac{1}{1} (-\lambda b_{n - 1} + 0) = \lambda b_{n - 1}, \quad n \geq 1
%     \end{cases}\\
% \end{align*}
% It follows that $b_n = \lambda^n$ for all $n \geq 0$. Hence $\frac{1}{1 - \lambda X} = 1 + \lambda X + \lambda^2 X^2 + \cdots \longleftrightarrow \{1, \lambda, \lambda^2, \dots\}$. In particular, when $\lambda = 1$, $\frac{1}{1 - X} = 1 + X + X^2 + \cdots \longleftrightarrow \{1, 1, 1, \dots\}$.
% \end{proof}

We have defined basic arithmetic operations on $\C\llbracket X\rrbracket$ and proven a few properties about them: we can add, subtract, multiply, and divide by invertible generating functions in the ways we are accustomed to. From an algebraic view, addition and multiplication on $\C\llbracket X\rrbracket$ forms an integral domain \autocite[873]{niven}, and further, a unique factorisation domain.

\section{Scaling and shifting}
Some multiplications have special significances on sequences. Namely, multiplying a generating function by a polynomial corresponds a combination of scaling and shifting of the sequence that it generates. We will start by studying the operations of scaling and shifting.

\begin{rem}\label{rem:gf-scaling}
\textbf{(scaling)} Let $f \longleftrightarrow \{a_n\}, c \in \C$. Then $c \cdot f \longleftrightarrow \{c a_n\}$.
\end{rem}

\begin{rem}\label{rem:gf-shifting}
\textbf{(shifting)} Let $f \longleftrightarrow \{a_n\}, c \in \N$. Then $X^c \cdot f \longleftrightarrow \{\overbrace{0, 0, \cdots, 0}^{c\text{ zeros}}, a_0, a_1, a_2, \cdots\}$. For simplicity, we define $a_{n}$ to be $0$ for any negative integer $n$. Thus $X^c \cdot f \longleftrightarrow \{a_{n - c}\}$.
\begin{alignat*}{7}
    f &= a_0 + a_1 &&X + \cdots + a_{c - 1} &&X^{c - 1} + a_c &&X^c + a_{c + 1} &&X^{c + 1} \cdots &&= \sum\nolimits_{n = 0}^\infty a_n X^n\\
    X^c \cdot f &= a_{-c} + a_{-c + 1}&&X + \cdots + a_{-1} &&X^{c - 1} + a_0 &&X^c + a_1 &&X^{c + 1}\cdots &&= \sum\nolimits_{n = 0}^\infty a_{n - c} X^n
\end{alignat*}
\end{rem}

With the distributivity of multiplication over addition, we can view the multiplication of a generating function of the sequence $\{a_n\}$ by a polynomial $P = p_0 + p_1 X + \cdots + p_n X^n$ as the sum of $\{a_n\}$ scaled by $p_i$ and shifted to the right by $i$ places, for $0 \leq i \leq n$.

\begin{cor}\label{cor:gf-1-lambda_X}
$\dfrac{1}{1 - \lambda X} \longleftrightarrow \{1, \lambda, \lambda^2, \dots\}$ for $\lambda \in \C^*.$
\end{cor}
\begin{proof}
Let $\frac{1}{1 - \lambda X} \longleftrightarrow \{a_n\}$.
By theorem~\ref{thm:gf-mult-inv}, $(1 - \lambda X) \cdot \dfrac{1}{1 - \lambda X} = 1$. Also, by remarks~\ref{rem:gf-scaling} and~\ref{rem:gf-shifting}, we can view this product as generating $\{a_n - \lambda a_{n - 1}\}$. Then, by lemma~\ref{lem:gf-id-r},
\begin{align*}
    \iff &\begin{cases}
    a_0 - \lambda a_{-1} &= 1\\
    a_n - \lambda a_{n - 1} &= 0, \quad n > 1
    \end{cases}\\
    \iff &\begin{cases}
    a_0 &= 1\\
    a_n &= \lambda a_{n - 1}, \quad n \geq 1
    \end{cases}\\
\end{align*}
It follows that $a_n = \lambda^n$ for all $n \geq 0$. Hence $\frac{1}{1 - \lambda X} = 1 + \lambda X + \lambda^2 X^2 + \cdots \longleftrightarrow \{1, \lambda, \lambda^2, \dots\}$. In particular, when $\lambda = 1$, $\frac{1}{1 - X} = 1 + X + X^2 + \cdots \longleftrightarrow \{1, 1, 1, \dots\}$.
\end{proof}

\section{Derivation}
\begin{defn}\label{def:gf-deriv}
\textbf{(derivative)} Let $f \longleftrightarrow \{a_n\}_0^\infty$. Then $f' \longleftrightarrow \{n a_n\}_1^\infty = \{(n + 1) a_{n + 1}\}_0^\infty$.
\begin{alignat*}{6}
    f &= a_0 + &&a_1 X + &&a_2 X^2 + &&a_3 X^3 + \cdots &&= \sum_{n = 0}^\infty a_n X^n\\
    f'&=       &&a_1 + 2 &&a_2 X + 3 &&a_3 X^2 + \cdots &&= \sum_{n = 1}^\infty n a_n X^{n - 1} = \sum_{n = 0}^\infty (n + 1) a_{n + 1} X^{n}
\end{alignat*}
\end{defn}
\begin{rem}\label{rem:gf-eq-deriv-eq}
If $f = g$, then $f' = g'$.
\end{rem}
\begin{rem}\label{rem:gf-constant-deriv}
If $c \in \C$, then $c' = 0$.
\end{rem}

\begin{prop}\label{prop:gf-sum-product-rules}
\textbf{sum rule}: $(f + g)' = f' + g'$; \textbf{product rule}: $(f \cdot g)' = f' \cdot g + f \cdot g'$.
\end{prop}
\begin{proof}
Let $f \longleftrightarrow \{a_n\}, g \longleftrightarrow \{b_n\}$. 
\begin{align*}
    (f + g)'
    &= \left(\sum_{n = 0}^\infty (a_n + b_n) X^n\right)'\\
    &= \sum_{n = 1}^\infty n (a_n + b_n) X^{n - 1}\\
    &= \left(\sum_{n = 1}^\infty n a_n X^{n - 1}\right) 
     + \left(\sum_{n = 1}^\infty n b_n X^{n - 1}\right)
     = f' + g'\\
    f' \cdot g + f \cdot g'
    &= \left(\sum_{n = 0}^\infty (n + 1) a_{n + 1} X^n\right)
       \left(\sum_{n = 0}^\infty b_n X^n\right)
     + \left(\sum_{n = 0}^\infty a_n X^n\right)
       \left(\sum_{n = 0}^\infty (n + 1) b_{n + 1} X^n\right)\\
    &= \left(\sum_{n = 0}^\infty \left(\sum_{k = 0}^n (k + 1) a_{k + 1} b_{n - k} \right) X^n\right)
     + \left(\sum_{n = 0}^\infty \left(\sum_{k = 0}^n a_k (n + 1 - k) b_{n + 1 - k } \right) X^n\right)\\
    &= \left(\sum_{n = 0}^\infty \left((n + 1) a_0 b_{n + 1} + \left(\sum_{k = 1}^n a_k b_{n + 1 - k} (n + 1 - k + k)\right) + (n + 1) a_{n + 1} b_0\right) X^n\right)\\
    &= \sum_{n = 0}^\infty (n + 1) \left(\sum_{k = 0}^{n + 1} a_k b_{n + 1 - k}\right) X^n\\
    &= \left(\sum_{n = 0}^\infty \left(\sum_{k = 0}^n a_k b_{n - k}\right) X^n\right)'
     = (f \cdot g)'
\end{align*}
\end{proof}

\begin{lem}\label{lem:gf-power-rule}
\textbf{(power rule)} Let $f \in \C\llbracket X \rrbracket, c \in \N$. Then $(f^c)'  = c f^{c - 1} \cdot f'$. Also, if $\dfrac{1}{f}$ exists, then $\left(\dfrac{1}{f^c}\right)' = -\dfrac{c}{f^{c + 1}} \cdot f'$. Note that we define $f^0$ to be $1$.
\end{lem}
\begin{proof}
To show $(f^c)' = c f^{c - 1} \cdot f'$ for $c \in \N$, we proceed by induction on $c$.
\begin{description}
\item \textit{Basis}: $(f^1)' = f' = 1 \cdot f^0 \cdot f'$ holds.
\item \textit{Inductive step}: Suppose $(f^c)' = c f^{c - 1} \cdot f'$ for some $c \in \N$; show that $(f^{c + 1})' = (c + 1) f^c \cdot f'$.
\begin{align*}
    (f^{c + 1})'
    &= (f^c \cdot f)'\\
    &= (f^c)' \cdot f + f^c \cdot f'\\
    &= c f^{c - 1} \cdot f' \cdot f + f^c \cdot f'\\
    &= (c + 1) f^c \cdot f'
\end{align*}
\item By the principle of mathematical induction, $(f^c)' = c f^{c - 1} \cdot f'$.
\end{description}

We then find $(\frac{1}{f^c})'$ with the product rule, remembering from remark~\ref{rem:gf-constant-deriv} that $1' = 0$:
\begin{align*}
    &f^c \cdot \frac{1}{f^c} = 1\\
    \implies &(f^c \cdot \frac{1}{f^c})' = 0\\
    &(f^c)' \cdot \frac{1}{f^c} + f^c \cdot \left(\frac{1}{f^c}\right)' = 0\\
    &\left(\frac{1}{f^c}\right)'= -\frac{c f^{c - 1} \cdot f'}{f^c} \cdot \frac{1}{f^c} = -\frac{c}{f^{c + 1}} \cdot f'.
\end{align*}
The quotient rule can be proved in the same manner.
\end{proof}

\begin{thm}\label{thm:gf-maclaurin}
\textbf{(Maclaurin's series)} Let $f \in \C\llbracket X \rrbracket$. Then $f = \sum_{n = 0}^\infty \dfrac{f^{(n)}[0]}{n!} X^n$, where $f^{(n)}$ denotes the $n$th derivative of $f$ with $f^{(0)} = f$, and $f[0]$ refers to the constant term $a_0$ in $f$. This allows us to extract the sequence $\{a_n\}$ from a generating function $f$ with \[a_n = \frac{f^{(n)}[0]}{n!}, \quad n \geq 0.\]
\end{thm}
\begin{proof}
Consider the $n$th derivatives of $f$:
\begin{align*}
f   &= a_0 + a_1 X + a_2 X^2 + a_3 X^3 + a_4 X^4 + \cdots\\
f'  &= a_1 + 2 a_2 X + 3 a_3 X^2 + 4 a_4 X^3 + \cdots\\
f'' &= 2 a_2 + 2 \times 3\,a_3 X + 3 \times 4\,a_4 X^2 + \cdots\\
&\vdots\\
f^{(n)} &= n!\,a_n + (n + 1)! / 1!\,a_{n + 1} X + (n + 2)! / 2!\,a_{n + 2} + \cdots
\end{align*}
We notice that $f^{(n)}[0] = n!\,a_n$, hence $a_n = \frac{f^{(n)}[0]}{n!}$.
\end{proof}

\begin{cor}\label{cor:gf-1-lambdaX-raised-to-c}
$\dfrac{1}{(1 - \lambda X)^c} \longleftrightarrow \{\binom{c + n - 1}{n} \lambda^n\}$ for $\lambda \in \C^*$.
\end{cor}
\begin{proof}
Let $f = \dfrac{1}{(1 - \lambda X)^c}$. By lemma~\ref{lem:gf-power-rule}, $f' = \dfrac{c \lambda}{(1 - \lambda X)^{c + 1}}, f'' = \dfrac{c(c + 1) \lambda^2}{(1 - \lambda X)^{c + 2}}, \dots$, 
\[
f^{(n)} 
= c (c + 1) \cdots (c + n - 1) \lambda^n \cdot \dfrac{1}{(1 - \lambda X)^{c + n}}
= \dfrac{(c + n - 1)!\,\lambda^n}{(c - 1)!} \cdot \dfrac{1}{(1 - \lambda X)^{c + n}}
.
\]
We continue by applying theorem~\ref{thm:gf-maclaurin} to find the sequence $\{a_n\}$ that $f$ generates. When calculating $f^{(n)}[0]$, one might be tempted to evaluate $f^{(n)}$ at $X = 0$. Although this substitution does not lead to issues of convergence from a power series view, it remains illegal for formal power series that we are working with. Instead, we should recognise that if $f[0] = 1$ (which we know is the case from corollary~\ref{cor:gf-1-lambda_X}), then $f^n[0] = 1$ for any positive integer $n$. This can be shown by induction on $n$: $f^1[0] = f[0] = 1$; if $f^k[0] = 1$ for a certain $k \in \N$, then $f^{k + 1}[0] = (f \cdot f^k)[0] = 1 \cdot 1 = 1$. Hence, we have 
\[a_n = \frac{f^{(n)}[0]}{n!} = \dfrac{(c + n - 1)!}{(c - 1)!\,n!} \lambda^n = \binom{c + n - 1}{n} \lambda^n.\]
In particular, when $\lambda = 1$, $a_n = \binom{c + n - 1}{n}$.
\end{proof}

\section{Summary}\label{sec:gf-summary}
We shall finish this chapter by summing up our findings:
\begin{table}[h!]
    \centering
    \begin{tabular}{c l l | c}
    \multicolumn{2}{c}{\textbf{Generating function}} & \multicolumn{1}{c}{\textbf{Sequence}} & \textbf{Notes}\\\hline
    
    &&&\\
    $1$ 
    & 
    & $\longleftrightarrow \{1, 0, 0, 0, 0, 0, 0, \dots\}$ 
    &see lemma~\ref{lem:gf-id-r}\\
    
    &&&\\
    $\dfrac{1}{1 - X}$ 
    & $= \sum_{n = 0}^\infty X^n$ 
    & $\longleftrightarrow \{1, 1, 1, 1, 1, 1, 1, \dots\}$ 
    &see corollary~\ref{cor:gf-1-lambda_X}\\
    
    &&&$\lambda \in \C^*$\\
    $\dfrac{1}{1 - \lambda X}$ 
    & $= \sum_{n = 0}^\infty \lambda^n X^n$ 
    & $\longleftrightarrow \{1, \lambda, \lambda^2, \lambda^3, \lambda^4, \lambda^5, \dots\}$ 
    &see corollary~\ref{cor:gf-1-lambda_X}\\
    
    % &&& $c \in \N$;\\
    % $(1 + X)^c$ 
    % & $= \sum_{n = 0}^\infty \binom{c}{n} X^n$ 
    % & $\longleftrightarrow \{1, c, \binom{c}{2}, \binom{c}{3}, \binom{c}{4}, \dots\}$
    % & $\binom{c}{n} = 0$ if $c > n$\\
    
    &&&$c \in \N$\\
    $\dfrac{1}{(1 - X)^c}$
    & $= \sum_{n = 0}^{\infty} \binom{c + n - 1}{n} X^n$
    & $\longleftrightarrow \{1, c, \binom{c + 1}{2}, \binom{c + 2}{3}, \dots\}$
    & see corollary~\ref{cor:gf-1-lambdaX-raised-to-c}\\
    
    &&&$c \in \N, \lambda \in \C^*$\\
    $\dfrac{1}{(1 - \lambda X)^c}$
    & $= \sum_{n = 0}^{\infty} \binom{c + n - 1}{n} \lambda^n X^n$
    & $\longleftrightarrow \{1, c \lambda, \binom{c + 1}{2} \lambda^2, \dots\}$
    & see corollary~\ref{cor:gf-1-lambdaX-raised-to-c}
    
    \end{tabular}
    %\caption{Caption}
    \label{tab:my_label}
\end{table}

Now that we have rigorously proven that many known properties of functions (e.g. the power rule and Maclaurin's series) are equally valid for generating functions, we can carry out these operations without a guilty conscience. Furthermore, by scaling, shifting, and referring to the table above, we can readily recover the sequence encoded in the generating function.





\chapter{Solving Recurrence Relations}\label{ch:recurrence}
We will now move on to explore one of the most important applications of generating functions: solving recurrence relations. In particular, we will focus on a special class of recurrence relations --- that of linear recurrence relations with constant coefficients.

\section{Linear homogeneous recurrence relations}
\subsection{Overview}
\begin{defn}\label{def:lin-homo-recur}
A \textbf{linear homogeneous recurrence relation} of order $k$ with constant coefficients is a recurrence relation of the form \[a_n = c_{k - 1} a_{n - 1} + c_{k - 2} a_{n - 2} + \cdots + c_0 a_{n - k}\]
where $c_0, c_1, \dots, c_{k - 1} \in \C$ are fixed and $c_{k - 1} \neq 0$.
A sequence $\{a_n\}$ is called a \textbf{solution} of the recurrence relation if its terms $a_n, a_{n - 1}, \dots, a_{n - k}$ satisfy the recurrence relation. For the sequence to be uniquely defined, apart from the recurrence relation, the values of $a_0, a_1, \dots, a_k$ must be specified; these are called \textbf{initial conditions}.
\end{defn}

\begin{thm}\label{thm:solve-lin-homo-recur}
Let $\{a_n\}$ be a sequence satisfying the lienar homogeneous recurrence relation
\[a_n = c_{k - 1} a_{n - 1} + c_{k - 2} a_{n - 2} + \cdots + c_0 a_{n - k}, \quad n \geq k\]
(for fixed $c_0, c_1, \dots, c_{k - 1} \in \C$). Consider the \textbf{characteristic polynomial} 
\[P = X^k - c_{k - 1} X^{k - 1} - c_{k - 2} X^{k - 2} - \cdots - c_0.\]
If $P = (X - \lambda_1)^{m_1 + 1} (X - \lambda_2)^{m_2 + 1} \cdots (X - \lambda_p)^{m_p + 1}$
where $\lambda_1, \lambda_2, \dots, \lambda_p$ are distinct, then 
\[a_n = Q_1 {\lambda_1}^n + Q_2 {\lambda_2}^n + \cdots + Q_p {\lambda_p}^n, \quad n \geq 0\]
where $Q_i = q_{i, 0} + q_{i, 1} n + \cdots + q_{i, m_i} n^{m_i}$ are determined by the initial conditions $a_0, a_1, \dots, a_{k - 1}$.
\end{thm}
\begin{sproof}
We can show that if $\{a_n\}$ and $\{b_n\}$ are solutions to the recurrence relation, then so are $\{k a_n\}$ (with $k \in \C$), $\{a_n + b_n\}$ and hence any linear combination of solutions. We can also verify that if $(X - \lambda)^m$ is a factor of the characteristic polynomial $P$, then $\{\lambda^n\}, \{n \lambda^n\}, \dots, \{n^{m - 1} \lambda^n\}$ are solutions to the linear recurrence. It follows that any linear combination of the form $\{q_0 \lambda^n + q_1 n \lambda^n + \cdots + q_{m - 1} n^{m - 1} \lambda^n\}$ is also a solution. The general solution is hence the sum of such combinations for all $\lambda$ and $m$. The particular solution, i.e. the constants $q_0, q_1, \dots, q_{m - 1}$, etc., is then determined by the initial conditions.
\end{sproof}

\subsection{Fibonacci sequence}
Recall the Fibonacci sequence from chapter~\ref{ch:intro}:
\[
\begin{cases}
F_0 &= 0\\
F_1 &= 1\\
F_n &= F_{n - 1} + F_{n - 2}, \quad n \geq 2
\end{cases}
\]

We now explain two methods to derive a closed-form expression for $F_n$: using the characteristic polynomial, and using generating functions. The first approach consists of a direct application of theorem~\ref{thm:solve-lin-homo-recur}; many parallels can be drawn between the second method  and the first, but moreover generating functions are of wide applicability.

\subsubsection{Characteristic polynomial}
The characteristic polynomial of the Fibonacci recurrence relation is
\[X^2 - X - 1 = \left(X - \frac{1 - \sqrt{5}}{2}\right)
                \left(X - \frac{1 + \sqrt{5}}{2}\right).
\]
By theorem~\ref{thm:solve-lin-homo-recur}, the solution to the recurrence relation is of the form 
\[F_n = \alpha \left(\frac{1 - \sqrt{5}}{2}\right)^n + \beta \left(\frac{1 + \sqrt{5}}{2}\right)^n, \quad n \geq 0\]
where the constants $\alpha$ and $\beta$ are determined by the initial conditions
\begin{align*}
    &\begin{cases}
    F_0 = \alpha \left(\frac{1 - \sqrt{5}}{2}\right)^0 + \beta \left(\frac{1 + \sqrt{5}}{2}\right)^0 = 0\\
    F_1 = \alpha \left(\frac{1 - \sqrt{5}}{2}\right)^1 + \beta \left(\frac{1 + \sqrt{5}}{2}\right)^1 = 1
    \end{cases}\\
    \iff &\begin{cases}
    \alpha = -\beta\\
    \frac{-1 + \sqrt{5}}{2} \beta + \frac{1 + \sqrt{5}}{2} \beta = 1
    \end{cases}\tag{*}\label{eq:rec-constants}\\
    \iff &\begin{cases}
    \alpha = -\dfrac{1}{\sqrt{5}}\\
    \beta = \dfrac{1}{\sqrt{5}}
    \end{cases}
\end{align*}
which lets us conclude that
\[F_n = -\frac{1}{\sqrt{5}} \left(\frac{1 - \sqrt{5}}{2}\right)^n + \frac{1}{\sqrt{5}} \left(\frac{1 + \sqrt{5}}{2}\right)^n, \quad n \geq 0.\]

This closed-form expression for the $n$th term of the Fibonacci sequence is known as ``Binet's formula'', despite Abraham de Moivre's prior discovery using generating functions early in the 18th century \autocite[83]{knuth}. Let us now study de Moivre's method.

\subsubsection{Generating functions}
Let $f$ be the generating function for the Fibonacci sequence $\{F_n\}$. Our goal is to find an expression for $f$ using operations from chapter~\ref{ch:gf}. Starting with the definition of $f$:

\begin{alignat*}{10}
f &= &F_0 &+ &F_1 X &+ &F_2 X^2 &+ &F_3 X^3 &+ &\cdots\\
X f &= & & &F_0 X &+ &F_1 X^2 &+ &F_2 X^3 &+ &\cdots\\
X^2 f &= & & & & &F_0 X^2 &+ &F_1 X^3 &+ &\cdots\\
\end{alignat*}

On the one hand, adding $X f$ and $X^2 f$, we obtain
\begin{align*}
    (X + X^2) f 
    &= 0 + F_0 X + (F_0 + F_1) X^2 + (F_1 + F_2) X^3 + \cdots\\
    &= 0 + 0 X + F_2 X^2 + F_3 X^3 + F_4 X^4 + \cdots\\
\end{align*}

On the other hand, observing the definition of $f$, we arrive at
\begin{align*}
    &f - F_0 - F_1 X = (F_0 - F_0) + (F_1 - F_1)X + F_2 X^2 + F_3 X^3 + \cdots\\
    \iff &f - X = 0 + 0X + F2 X^2 + F_3 X^3 + \cdots\\
    \iff &f - X = (X + X^2) f
\end{align*}

Therefore \[f = \frac{X}{1 - X - X^2}.\]

Having obtained an expression for $f$, we are now interested in extracting sequence $\{F_n\}$. Certainly, theorem~\ref{thm:gf-maclaurin} tells us that it is possible to use the Maclaurin's series; the problem, however, is that we do not know the formula for the $n$th derivative of $f$. Instead, we can decompose $f$ into partial fractions of the forms that we are familiar with (see section~\ref{sec:gf-summary}):
\[
    f
    = \frac{X}{
     (1 - \frac{1 - \sqrt{5}}{2} X)
     (1 - \frac{1 + \sqrt{5}}{2} X)
    }
    = \frac{\alpha}{1 - \frac{1 + \sqrt{5}}{2} X} + \frac{\beta}{1 - \frac{1 - \sqrt{5}}{2} X}
\]
where $\alpha$ and $\beta$ satisfy $\alpha(1 - \frac{1 - \sqrt{5}}{2}X) + \beta(1 - \frac{1 + \sqrt{5}}{2}X) = X$, i.e.
\[
\begin{cases}
\alpha + \beta = 0\\
\frac{1 - \sqrt{5}}{2} \alpha + \frac{1 + \sqrt{5}}{2} \beta = 1
\end{cases}
\]
which is identical to (\ref{eq:rec-constants}) from the first approach, giving $\alpha = -\frac{1}{\sqrt{5}}$ and $\beta = \frac{1}{\sqrt{5}}$. Hence, 
\[
F_n = -\frac{1}{\sqrt{5}} \left(\frac{1 - \sqrt{5}}{2}\right)^n + \frac{1}{\sqrt{5}} \left(\frac{1 + \sqrt{5}}{2}\right)^n, \quad n \geq 0
\]
which, too, is identical to what we have found with the first approach. 

Having noticed some striking similarities between the two methods, we should proceed to discuss the relations between linear homogeneous recurrence relations and generating functions.

\subsection{Finding the generating function}
Consider the generating function $f = \dfrac{P}{Q}$, where $P = p_0 + p_1 X + p_2 X^2 + \cdots + p_m X^m$ and $Q = q_0 + q_1 X + \cdots + q_k X^k$ and $q_0 \neq 0$ (since otherwise $\dfrac{1}{Q}$ will not be defined in $\llbracket \C \rrbracket$). For example, the generating function for the Fibonacci sequence is $\dfrac{X}{1 - X - X^2}$. What kind of information can we learn about the sequence $\{a_n\}$ from its generating function?

Firstly, we make the observation that having $Q$ in the denominator is not very helpful to reason about the sequence. We then multiply both sides by $Q$:
\begin{align*}
    Q \cdot f &= Q \cdot \frac{P}{Q} = P\\
    (q_0 + q_1 X + \cdots + q_k X^k) \cdot f &= p_0 + p_1 X + p_2 X^2 + \cdots + p_m X^m
\end{align*}

Recalling what remarks~\ref{rem:gf-scaling} and~\ref{rem:gf-shifting} tell us about scaling and shifting, we can view the left hand side of the equation as generating the sequence $\{q_0 a_n + q_1 a_{n - 1} + \cdots + q_m a_{n - m}\}$. Then, definition~\ref{def:gf-eq} allows us to identify each term and establish the following relations:
\begin{align*}\label{eq:rec-reational-fxn}
&q_0 a_n + q_1 a_{n - 1} + \cdots + q_n a_{n - m} = p_n, \quad n \geq 0\\
\iff &\begin{cases}
    q_0 a_n + q_1 a_{n - 1} + \cdots + q_n a_{n - m} = p_n, & 0 \leq n \leq m\\
    q_0 a_n + q_1 a_{n - 1} + \cdots + q_n a_{n - m} = 0,   & n > m
\end{cases}\\
\iff &\begin{cases}
    a_n = \frac{1}{q_0} (p_n - \sum_{i = 1}^{n} q_i a_{n - i}), & 0 \leq n \leq m \\
    a_n = (-\frac{q_1}{q_0}) a_{n - 1} + \cdots + (-\frac{q_n}{q_0}) a_{n - m}, & n > m 
\end{cases}\tag{**}
\end{align*}

Since we defined $a_{-n}$ to be $0$ for all $n \geq 0$, the first part of (\ref{eq:rec-reational-fxn}) corresponds to the \textbf{initial conditions} $a_0, a_1, \dots, a_m$, and the second part defines a linear homogeneous \textbf{recurrence relation} of order $k$ with constant coefficients.

\begin{thm}\label{thm:gf-to-linrec}
Every generating function of the form $\dfrac{P}{Q}$ corresponds to a sequence satisfying a linear homogeneous recurrence relation of order $k$ with constant coefficients, where $P$ is a polynomial and $Q = q_0 + q_1 X + \cdots + q_k X^k$ with $q_0 \neq 0$. Conversely, the generating function of a sequence satisfying a linear homogeneous recurrence relation takes this form.
\end{thm}
\begin{proof}
We have shown above how to identify the sequence from its generating function. Conversely, to find the generating function $f$ of a sequence $\{a_n\}$, we propose the following:

\begin{enumerate}\vspace{-0.1cm}
    \item Identify the recurrence relation $a_n = c_{k - 1} a_{n - 1} + c_{k - 2} a_{n - 2} + \cdots + c_0 a_{n - k}, \quad n \geq k$.\vspace{-0.125cm}
    \item Multiply both sides of the recurrence relation by $X^n$, and sum over all $n \geq k$.\vspace{-0.125cm}
    \item The left hand side becomes $\sum_{n = k}^{\infty} a_n X^n = f - a_0 - a_1 X - \cdots - a_{k - 1} X^{k - 1}$. The right hand side becomes the sum of $\sum_{n=k}^\infty c_{k - i} a_{n - i} X^n = c_{k - i} X^i \sum_{n = k}^\infty a_{n - i} X^{n - i}$ which equals $c_{k - i} X^i \sum_{n = k - i}^\infty a_n X^n = c_{k - i} X^i (f - \sum_{j = 0}^{k - i - 1} a_{j} X^j )$ for $i$ ranging from $1$ to $k$. \vspace{-0.125cm}
    \item Hence obtain $f$ as a ratio of two polynomials, $\frac{P}{Q}$.\vspace{-0.125cm}
\end{enumerate}

This procedure is functional because $f$ allows us to manipulate $\{a_n\}$ in many ways.
\end{proof}

\subsection{Decomposing the generating function}
Theorem \ref{thm:gf-to-linrec} allows us to find the generating function $f = \frac{P}{Q}$ for the linear homogeneous recurrence relation $a_n = c_{k - 1} a_{n - 1} + c_{k - 2} a_{n - 2} + \cdots + c_0 a_{n - k}$. Following the previously outlined procedure, we can identify that $Q = 1 - c_{k - 1} X - c_{k - 2} X^2 - \cdots - c_{0}$. If we compare this with the characteristic polynomial $X^k - c_{k - 1} X^{k - 1} - c_{k - 2} X^{k - 2} - \cdots - c_{0}$, we can see that $Q$ is the reflected version of the characteristic polynomial. We observe the following:

\begin{rem}\label{lem:roots-reflected-poly}
Let $P = p_0 + p_1 X + \cdots + p_n X^n$. $P^*$ denotes its \textbf{reflected polynomial}, $p_n + p_{n - 1} X + \cdots + p_0 X^n$. If $P = (X - \lambda_1) (X - \lambda_2) \cdots (X - \lambda_n)$ where $\lambda_1, \lambda_2, \dots, \lambda_n \in \C$ are allowed to repeat, then $P^* = (1 - \lambda_1 X)(1 - \lambda_2 X)\cdots(1 - \lambda_n X)$. This can be easily shown by comparing the coefficient of $X^k$ in $P^*$ and the coefficient of $X^{n - k}$ in $P$ for $k$ ranging from $0$ to $n$. 
\end{rem}

In addition, the procedure also reveals that the term with the highest degree in the numerator $P$ is $X^i \cdot X^{k - i - 1} = X^{k - 1}$. Then, if the characteristic polynomial can be factored into $(X - \lambda_1)^{m_1} \cdots (X - \lambda_p)^{m_p + 1}$ where $\lambda_1, \dots, \lambda_p$ are distinct, then its reflected polynomial $Q$ can be factored into $(1 - \lambda_1 X)^{m_1 + 1} \cdots (1 - \lambda_p X)^{m_p + 1}$, and $\dfrac{P}{Q}$ can be decomposed into
\[\frac{\alpha_{1, m_1 + 1}}{(1 - \lambda_1 X)^{m_1 + 1}} + \cdots + \frac{\alpha_{1, 1}}{1 - \lambda_1 X} + \cdots + \frac{\alpha_{p, m_p + 1}}{(1 - \lambda_p X)^{m_p + 1}} + \cdots + \frac{\alpha_{p, 1}}{1 - \lambda_p X}.\]

From section~\ref{sec:gf-summary}, we know that $\dfrac{1}{(1 - \lambda X)^c}$ for $c \in \N$ and $\lambda \in \C$ generates $\{\binom{c + n - 1}{n} \lambda^n\}$. This shares many similarities with theorem~\ref{thm:solve-lin-homo-recur}: the constants $\alpha_{i, j}$ are determined by the initial conditions; for $\lambda_i$ of multiplicity $m_i + 1$, $\alpha_{i, m_i + 1} \binom{m_i + n}{n} \lambda^n + \cdots + \alpha_{i, 1} \binom{n}{n} \lambda^n = Q \cdot \lambda^n$, where $Q = \alpha_{i, 1} + \cdots + \alpha_{i, m_i + 1}(m_i + n)(m_i + n - 1)\cdots(1 + n)/(m_i(m_i - 1)\cdots1)$ is a polynomial in $n$ of degree $m_i$, contributes to the solution.

\section{Linear Non-homogeneous Recurrence Relations}Perhaps generating functions didn't seem to simplify the process of solving linear homogeneous recurrence relations. Indeed, they are much more powerful when it comes to non-homogeneous recurrence relations.

\subsection{Relation with linear homogeneous recurrence relations}
\begin{defn}
A \textbf{linear non-homogeneous recurrence relation} is a recurrence relation of the form
\[a_n = c_{k - 1}a_{n - 1} + c_{k - 2}a_{n - 2} + \cdots + c_0 a_{n - k} + g_n\]
where $c_0, \dots, c_{k - 1} \in \C$. The recurrence relation becomes homogeneous when $\forall n, g_n = 0$.
\end{defn}

\begin{prop}
If $\{b_n\}$ is a particular solution to the non-homogeneous recurrence relation, and $\{a_n\}$ is any solution to the corresponding homogeneous recurrence relation (with $g_n = 0$), then $\{a_n + b_n\}$ is a solution to the non-homogeneous recurrence relation.
\end{prop}

\begin{proof}
\[\begin{cases}
    a_n = c_{k - 1}a_{n - 1} + c_{k - 2}a_{n - 2} + \cdots + c_0 a_{n - k} \\
    b_n = c_{k - 1}b_{n - 1} + c_{k - 2}b_{n - 2} + \cdots + c_0 b_{n - k} + g_n\\
    \end{cases}
\]
Hence $(a_n + b_n) = c_{k - 1}(a_{n - 1} + b_{n - 1}) + c_{k - 2}(a_{n - 2} + b_{n - 2}) + \cdots + c_0 (a_{n - k} + b_{n - k}) + g_n$.
\end{proof}
As a consequence, we only need to find $\{a_n\}$ such that $\{a_n + b_n\}$ satisfies the initial conditions. On the other hand, the particular solution $\{b_n\}$ has to be guessed. Here is where generating functions come into play.

\subsection{Solving with generating functions}
Let us look at a simple example: the sum of squares, $s_n = \sum_{i = 0}^n i^2$. It can be formulated as a linear non-homogeneous recurrence relation:
\[
\begin{cases}
s_0 = 0\\
s_n = s_{n - 1} + n^2, \quad n \geq 1
\end{cases}
\]

Let $f$ be the generating function for $\{s_n\}$. Carrying out the precedure from theorem~\ref{thm:gf-to-linrec},
\begin{align*}
&\sum_{n = 1}^\infty s_n X^n = \sum_{n = 1}^\infty s_{n - 1}X^n + \sum_{n = 1}^\infty n^2 X^n\\
\iff &f - s_0 = X f + \sum_{n = 0}^\infty n^2 X^n - 0^2\\
\iff &(1 - X)f = \sum_{n = 0}^\infty n^2 X^n
\end{align*}

We need to find the generating function for $\{n^2\}$. Starting from $\frac{1}{1 - X} = 1 + X + X^2 + \cdots$,
\begin{align*}
    \left(\frac{1}{1 - X}\right)' &= 1 + 2X + 3X^2 + 4X^3 + \cdots\\
    X \left(\frac{1}{1 - X}\right)' &= 0 + X + 2X^2 + 3 X^3 + \cdots\\
    \left(X \left(\frac{1}{1 - X}\right)'\right)' &= 1 + 4X + 9X^2 + 16X^3\cdots\\
    X \left(X \left(\frac{1}{1 - X}\right)'\right)' &= 0 + X + 4X^2 + 9 X^3\cdots\\
\end{align*}

Hence, $\{n^2\}$ is generated by 
\[X \left(X \left(\frac{1}{1 - X}\right)'\right)' = X \left( \frac{X}{(1 - X)^2} \right)' = X \frac{(1 - X)^2 + 2 X (1 - X)}{(1 - X)^4} = \frac{X + X^2}{(1 - X)^3}.\]

Then, 
\[f = \frac{X + X^2}{(1 - X)^4} = X \cdot \frac{1}{(1 - X)^4} + X^2 \cdot \frac{1}{(1 - X)^4}.\]

From section~\ref{sec:gf-summary}, we know that $\dfrac{1}{(1 - X)^4}$ generates the sequence $\binom{n + 3}{n}$. Therefore,
\[s_n = \binom{n + 2}{n - 1} + \binom{n + 1}{n - 2} = \frac{(n + 2) (n + 1) n}{3 \times 2 \times 1} + \frac{(n + 1) n (n - 1)}{3 \times 2 \times 1} = \frac{n (n + 1) (2n + 1)}{6}.\]

Interestingly, the generating function $f$ of this non-homogeneous recurrence relation also takes the form $\frac{P}{Q}$. By theorem~\ref{thm:gf-to-linrec}, $f$ corresponds to a homogeneous recurrence relation. Indeed, as $(1 - 4X + 6X^2 - 4X^3 + X^4) f = X + X^2$,
\[
\begin{cases}
s_0 = 0, s_1 = 1, s_2 = 5, s_3 = 14,\\
s_n = 4s_{n - 1} - 6s_{n - 2} + 4 s_{n - 3} - s_{n - 4}, \quad n \geq 4.
\end{cases}
\]

At last, we shall finish by considering what kind of non-homogeneous recurrence relations generating functions enable us to solve.
\begin{thm}
Let $a_n = c_{k - 1}a_{n - 1} + c_{k - 2}a_{n - 2} + \cdots + c_0 a_{n - k} + g_n$ for $n \geq k$. The generating function of $\{a_n\}$ takes the form $\frac{P}{Q}$ if and only if \[g_n = \sum_{j = 1}^{m} {\alpha_j}^n P_j\]
where $m \in \N$ and $P_j$ is a polynomial in $n$.
\end{thm}
\begin{proof}
It suffices to find the generating function of $g_n$ by combining manipulations. Specifically, each term $\{n^k\}$ with $k \in \N$ in $\{P_j\}$ is generated by $X\left(\overbrace{\cdots}^{k \text{ times}} X\left(\frac{1}{1 - X}\right)'\cdots\right)'$, which can be then scaled to its coefficient. In addition, we notice that if we substitute $X$ with $\alpha X$ in $f = a_0 + a_1 X + a_2 X^2 + \cdots$, we obtain $a_0 + (a_1 \alpha) X + (a_2 \alpha^2) X^2 + \cdots$. Hence, we can substitute $X$ with $\alpha_j X$ in $P_j$ to generate $\{{a_j}^n P_j\}$. For instance, by substituting $X$ with $2X$ in $\dfrac{X + X^2}{(1 - X)^3} \longleftrightarrow \{n^2\}$, we arrive at $\dfrac{(2X + 4X^2)}{(1 - 2X)^3} \longleftrightarrow \{2^n n^2\}$.
\end{proof}

{\let\clearpage\relax\chapter{Discussions and Summary}}\vspace{-0.7cm}
% Synthesis of arguments: new connections/understanding, insights, big picture
% Description, explanation, justification of conclusion
% Reflective comments: confidence, more time, Q > A
% ! Inappropriate to introduce new arguments
% 

So far, we have defined generating functions as formal power series, introduced a few operations on them and explained their respective significance on the corresponding sequence, and studied one of their most important applications --- solving linear recurrence relations. We shall now return to address some doubts raised during the process.
\clearpage
\section{Why the form \texorpdfstring{$f = \sum_{n = 0}^\infty a_n X^n$}\text{?}}

The gist of generating functions is to encode the sequence $\{a_n\}$ as a power series $a_0 + a_1 X + a_2 X^2 + \cdots$ to make many manipulations possible. For example, we defined multiplication of generating functions as the convolution of the two sequences, and have shown that it has the properties that we presumed with multiplication: it is associative, commutative, and distributive over addition; $0$ and $1$ respectively play the roles of the null element and the identity element; the product of any non-null generating functions is not null; lastly, each generating function with a non-zero constant term has a unique multiplicative inverse, which allowed us to define division and fractions. We can, of course, prove these properties with the notion of convolution only and without introducing generating functions; this comes at the expense of intuitiveness and succinctness, however, since the operations of shifting and taking derivatives would become unwieldy to employ using a sequence. This corresponds to Leibniz's remark \autocite[1]{zorich}: ``If the notation is adapted to the discoveries..., the work of thought is marvellously shortened.'' 

Regarding the particular form of the series, $a_0 $ is in fact known as the \textbf{ordinary} generating functions. One of their most important uses is to reveal structural information about a sequence, such as solving linear recurrence relations. There exist other kinds of generating functions of other forms, each suited for different purposes. To list a few, the exponential generating functions $\sum_{n = 0}^\infty a_n \frac{X^n}{n!}$ find use in combinatorical problems, while the series $\sum_{n = 0}^\infty a_n e^{-i\omega n}$ is related to the discrete-time Fourier transform.

\section{Are ``generating functions'' functions?}
Within the scope of this essay, generating functions are treated as formal power series instead of functions. Nonetheless, the formal derivative is analogous to the habitual derivative of polynomials; the sum rule, product rule, power rule, and quotient rule from differential calculus are equally valid; an alternative formulation of Maclaurin's series is available. They are still functions in the sense that they share common operations and properties.

Just like how polynomials are algebraic objects and analytic functions at the same time, generating functions --- generalisation of polynomials to infinite degrees --- are formal power series and complex-valued functions at the same time. In treating generating functions as complex-valued functions, issues of convergence kick in; at the same time, complex analysis allows us to obtain additional information within the radius of convergence: for example, we can obtain asymptotic information about a sequence, which computer scientists are interested in, by considering the locations of the poles of the function. It is this duality connecting discrete mathematics and continuous analysis that render generating functions powerful and charming. After all, as Poincaré remarked \autocite[1]{zorich}, ``Mathematics is the art of calling different things by the same name.''


\nocite{*}
\printbibliography
\thispagestyle{empty}
\end{document}